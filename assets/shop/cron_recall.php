<?php
die;
// Подключаем
define('MODX_API_MODE', true);
define ('ROOT', dirname(dirname(dirname(__FILE__))));
define ('MODX_BASE_PATH', ROOT.'/');
define ('MODX_BASE_URL', '/');
define ('MODX_SITE_URL', 'https://pdr-online.com.ua/');
require ROOT.'/index.php';
include MODX_BASE_PATH . "assets/shop/shop.class.php";
$shop = new Shop($modx);


require_once MODX_BASE_PATH . "assets/shop/php/gpt.php";
$gpt = new Gpt($modx);

$q = $modx->db->query('SELECT * FROM `modx_a_instructors` WHERE school = "122" AND status = "1" ORDER BY rand() LIMIT 2');
while($r = $modx->db->getRow($q)){


	$promt = 'Завдання: Написати відгук про наших автоінструкторів без згадки автошколи.

	Цільова аудиторія: Потенційні учні, які шукають професійного та досвідченого автоінструктора.

	Вимоги до тексту:

	 1. Структура відгуку:
	 Вступ: Короткий опис автоінструктора, його загального досвіду та підходу до навчання.
	 • Основна частина: Детальний опис досвіду навчання з конкретним автоінструктором. Тут можна вказати:
	 • Особисті якості інструктора, які роблять навчання комфортним і ефективним (наприклад, терпіння, доброзичливість, вміння заспокоювати в стресових ситуаціях).
	 • Професійні якості, що виділяють інструктора серед інших (наприклад, великий досвід, глибокі знання правил дорожнього руху, вміння адаптувати методи навчання під потреби учня).
	 • Особливі моменти, які зробили навчання з інструктором унікальним (наприклад, індивідуальний підхід, використання сучасних навчальних методик, акцент на безпеці).
	 • Заключення: Загальне враження від навчання з інструктором, рекомендації іншим потенційним учням.
	 2. Тональність та стиль:
	 • Текст має бути написаний у позитивному, довірчому стилі.
	 • Використовуйте просту, зрозумілу мову, уникаючи спеціалізованих термінів, якщо це можливо.
	 • Відгук повинен викликати відчуття впевненості у професіоналізмі інструктора.
	 3. Об’єм тексту:
	 • Від 40 до 100 слів.
	 4. Ключові моменти, які слід включити:
	 • Ім’я автоінструктора (якщо дозволено).
	 • Опис позитивних особистих і професійних якостей інструктора.
	 • Приклади ситуацій або особливих моментів, які підкреслюють професіоналізм інструктора.
	 • Рекомендації для майбутніх учнів.
	 5. Приклади та цитати:
	 • Можна включити вигадані цитати від учнів, які підкреслюють позитивний досвід навчання з інструктором.
	 6. Ім`я інструктора про якого пишеться відгук: '.$r['fullname'].' (це ім`я можна використовувати у відгуку)
	Додаткові вимоги:

	 • Текст має бути унікальним (не скопійованим з інших ресурсів).
	 • Перевірити текст на наявність граматичних і орфографічних помилок.
	 Перед початком тексту має бути придумане Ім`я людини від якої написано відгук далі символ == і після цього відгук за правилами вище 
	 ';

	$answer = $gpt->askQuestion($promt);
	$exp = explode('==', $answer);
	$recall = str_replace('<p></p>', '',$shop->beutifyGptText($exp[1]));

	$modx->db->query('INSERT INTO `modx_a_recall` SET
		recall_mark      = "5",
		recall_pub_date  = "'.$modx->db->escape(date('Y-m-d H:i:s')).'",
		recall_name      = "'.$modx->db->escape(trim(strip_tags($exp[0]))).'",
		recall_email     = "'.$modx->db->escape(uniqid().'@pdr-online.com.ua').'",
		recall_text      = "'.$modx->db->escape($recall).'",
		recall_content   = "'.$modx->db->escape($r['id']).'",
		recall_type	     = "1",
		recall_moderated = "1"
	');
}
?>